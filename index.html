<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cuenta regresiva — Llegada de tu esposa (22 nov 2025, 11:00 CET)</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#7dd3fc;--muted:#9ca3af}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
    body{background:linear-gradient(180deg,#071028 0%, #071726 100%);display:flex;align-items:center;justify-content:center;color:white}
    .wrap{width:min(920px,95%);padding:28px;border-radius:18px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));box-shadow:0 10px 30px rgba(2,6,23,0.6);text-align:center}
    h1{margin:0 0 10px;font-weight:700;font-size:20px;letter-spacing:-0.02em}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .counter{display:flex;gap:12px;justify-content:center;align-items:stretch}
    .segment{background:rgba(255,255,255,0.03);padding:18px 20px;border-radius:12px;min-width:110px}
    .num{font-size:48px;font-weight:800;line-height:1;color:var(--accent);}    
    .label{font-size:14px;color:var(--muted);margin-top:6px}
    .big{font-size:110px}
    .status{margin-top:14px;color:var(--muted)}
    .small-note{margin-top:18px;color:var(--muted);font-size:13px}
    @media (max-width:640px){.counter{flex-wrap:wrap}.segment{min-width:90px;padding:12px}.num{font-size:36px}.big{font-size:72px}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Cuenta — llegada prevista: <strong>22 nov 2025 · 11:00</strong> de Claudia a Barcelona</h1>
    <p class="lead">Esta página muestra el tiempo restante hasta la llegada (o el tiempo transcurrido desde ella). La hora objetivo está fijada en 22/11/2025, Sabado 10h00 (hora de España).</p>

    <div id="display" style="margin:22px 0">
      <div class="counter" id="countDown">
        <div class="segment">
          <div class="num" id="days">--</div>
          <div class="label">Días</div>
        </div>
        <div class="segment">
          <div class="num" id="hours">--</div>
          <div class="label">Horas</div>
        </div>
        <div class="segment">
          <div class="num" id="minutes">--</div>
          <div class="label">Minutos</div>
        </div>
        <div class="segment">
          <div class="num" id="seconds">--</div>
          <div class="label">Segundos</div>
        </div>
      </div>

      <div style="margin-top:18px">
        <div class="big" id="mainBig">--:--:--</div>
        <div class="status" id="statusLine">Calculando...</div>
      </div>
    </div>

    <div class="small-note">La cuenta usa la hora del navegador convertida a la zona <strong>Europe/Madrid</strong>. Si la hora del dispositivo está mal, los cálculos también lo estarán.</div>
  </div>

  <script>
    // Utility: get date/time parts for a given instant in Europe/Madrid
    function madridPartsFor(date = new Date()){
      const fmt = new Intl.DateTimeFormat('en-GB',{
        timeZone: 'Europe/Madrid',
        year: 'numeric', month: 'numeric', day: 'numeric',
        hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: false
      });
      const parts = fmt.formatToParts(date);
      const obj = {};
      for(const p of parts) if(p.type !== 'literal') obj[p.type] = Number(p.value);
      // parts: year,month,day,hour,minute,second
      return obj;
    }

    // Calculate the timezone offset (ms) between the labelled Madrid wall-time and UTC
    function tzOffsetMs(now = new Date()){
      const p = madridPartsFor(now);
      const assumedUtcMs = Date.UTC(p.year, p.month-1, p.day, p.hour, p.minute, p.second);
      return now.getTime() - assumedUtcMs; // ms to add to Madrid-wall-time UTC-millis to get actual instant
    }

    // Build target Madrid datetime → return UTC timestamp
    function madridTargetUtcMs(year, month, day, hour=11, minute=0, second=0){
      const assumedUtcMs = Date.UTC(year, month-1, day, hour, minute, second);
      // use tz offset computed for the target date to handle DST correctly
      const targetDateForOffset = new Date(assumedUtcMs);
      const offset = tzOffsetMs(targetDateForOffset);
      return assumedUtcMs + offset;
    }

    function pad(n){return String(n).padStart(2,'0');}

    function msToParts(ms){
      const totalSeconds = Math.floor(ms/1000);
      const seconds = Math.abs(totalSeconds % 60);
      const totalMinutes = Math.floor(Math.abs(totalSeconds)/60);
      const minutes = totalMinutes % 60;
      const totalHours = Math.floor(totalMinutes/60);
      const hours = totalHours % 24;
      const days = Math.floor(totalHours/24);
      return {days, hours, minutes, seconds};
    }

    // TARGET: 22 Nov 2025 11:00 Europe/Madrid
    const TARGET = { year: 2025, month: 11, day: 22, hour: 10, minute: 40, second: 0 };
    const targetUtcTs = madridTargetUtcMs(TARGET.year, TARGET.month, TARGET.day, TARGET.hour, TARGET.minute, TARGET.second);

    function update() {
      const now = new Date();
      const nowMs = now.getTime();
      let diff = targetUtcTs - nowMs; // positive -> time remaining, negative -> already passed

      const daysEl = document.getElementById('days');
      const hoursEl = document.getElementById('hours');
      const minutesEl = document.getElementById('minutes');
      const secondsEl = document.getElementById('seconds');
      const mainBig = document.getElementById('mainBig');
      const statusLine = document.getElementById('statusLine');

      if(diff >= 0){
        const t = msToParts(diff);
        daysEl.textContent = t.days;
        hoursEl.textContent = pad(t.hours);
        minutesEl.textContent = pad(t.minutes);
        secondsEl.textContent = pad(t.seconds);
        const totalHours = t.hours + t.days * 24;
        mainBig.textContent = `${totalHours}:${pad(t.minutes)}:${pad(t.seconds)}`;
        statusLine.textContent = `Faltan ${t.days}d ${t.hours}h ${t.minutes}m ${t.seconds}s para las 11:00 (22/11/2025, hora de España).`;
      } else {
        // already passed
        const e = msToParts(-diff);
        daysEl.textContent = e.days;
        hoursEl.textContent = pad(e.hours);
        minutesEl.textContent = pad(e.minutes);
        secondsEl.textContent = pad(e.seconds);
        const totalHours = e.hours + e.days * 24;
        mainBig.textContent = `+${totalHours}:${pad(e.minutes)}:${pad(e.seconds)}`;
        statusLine.textContent = `Llegó hace ${e.days}d ${e.hours}h ${e.minutes}m ${e.seconds}s.`;
      }
    }

    // Start updates
    update();
    setInterval(update, 200);
  </script>
</body>
</html>
