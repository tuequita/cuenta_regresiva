<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cuenta regresiva — Llegada de tu esposa (11:00, España)</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#7dd3fc;--muted:#9ca3af}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
    body{background:linear-gradient(180deg,#071028 0%, #071726 100%);display:flex;align-items:center;justify-content:center;color:white}
    .wrap{width:min(920px,95%);padding:28px;border-radius:18px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));box-shadow:0 10px 30px rgba(2,6,23,0.6);text-align:center}
    h1{margin:0 0 10px;font-weight:700;font-size:20px;letter-spacing:-0.02em}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .counter{display:flex;gap:12px;justify-content:center;align-items:stretch}
    .segment{background:rgba(255,255,255,0.03);padding:18px 20px;border-radius:12px;min-width:110px}
    .num{font-size:48px;font-weight:800;line-height:1;color:var(--accent);}
    .label{font-size:14px;color:var(--muted);margin-top:6px}
    .big{font-size:110px}
    .status{margin-top:14px;color:var(--muted)}
    .small-note{margin-top:18px;color:var(--muted);font-size:13px}
    @media (max-width:640px){.counter{flex-wrap:wrap}.segment{min-width:90px;padding:12px}.num{font-size:36px}.big{font-size:72px}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Cuenta — llegada a las <strong>11:00</strong> (zona: Europe/Madrid)</h1>
    <p class="lead">La página usa la hora actual en la zona horaria de España (Europe/Madrid) para mostrar cuánto falta o cuánto ha pasado desde las 11:00.</p>

    <div id="display" style="margin:22px 0">
      <div class="counter" id="countDown">
        <div class="segment">
          <div class="num" id="days">--</div>
          <div class="label">Días</div>
        </div>
        <div class="segment">
          <div class="num" id="hours">--</div>
          <div class="label">Horas</div>
        </div>
        <div class="segment">
          <div class="num" id="minutes">--</div>
          <div class="label">Minutos</div>
        </div>
        <div class="segment">
          <div class="num" id="seconds">--</div>
          <div class="label">Segundos</div>
        </div>
      </div>

      <div style="margin-top:18px">
        <div class="big" id="mainBig">--:--:--</div>
        <div class="status" id="statusLine">Calculando...</div>
      </div>
    </div>

    <div class="small-note">La cuenta está sincronizada con la hora actual del navegador pero convertida a la zona <strong>Europe/Madrid</strong>. Si tu navegador tiene la hora incorrecta, los valores pueden variar.</div>
  </div>

  <script>
    // Utility: get date/time parts for a given instant in Europe/Madrid
    function madridPartsFor(date = new Date()){
      const fmt = new Intl.DateTimeFormat('en-GB',{
        timeZone: 'Europe/Madrid',
        year: 'numeric', month: 'numeric', day: 'numeric',
        hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: false
      });
      const parts = fmt.formatToParts(date);
      const obj = {};
      for(const p of parts) if(p.type !== 'literal') obj[p.type] = Number(p.value);
      // parts: year,month,day,hour,minute,second
      return obj;
    }

    // Calculate the timezone offset (ms) between the labelled Madrid wall-time and UTC
    function tzOffsetMs(now = new Date()){
      const p = madridPartsFor(now);
      const assumedUtcMs = Date.UTC(p.year, p.month-1, p.day, p.hour, p.minute, p.second);
      return now.getTime() - assumedUtcMs; // ms to add to a Madrid-wall-time UTC-millis to get actual instant
    }

    // Build target 11:00 for a given Madrid date (year,month,day) and return the UTC timestamp (ms)
    function madridTargetUtcMs(year, month, day, hour=11, minute=0, second=0){
      const assumedUtcMs = Date.UTC(year, month-1, day, hour, minute, second);
      return assumedUtcMs + tzOffsetMs(new Date());
    }

    function pad(n){return String(n).padStart(2,'0');}

    function update(){
      const now = new Date();
      const p = madridPartsFor(now);
      // today's 11:00
      const todayTarget = madridTargetUtcMs(p.year, p.month, p.day, 11,0,0);
      const nowMs = now.getTime();

      let diff = todayTarget - nowMs; // ms until today's 11:00 (negative if passed)

      const daysEl = document.getElementById('days');
      const hoursEl = document.getElementById('hours');
      const minutesEl = document.getElementById('minutes');
      const secondsEl = document.getElementById('seconds');
      const mainBig = document.getElementById('mainBig');
      const statusLine = document.getElementById('statusLine');

      if(diff >= 0){
        // countdown to today's 11:00
        const t = msToParts(diff);
        daysEl.textContent = t.days;
        hoursEl.textContent = pad(t.hours);
        minutesEl.textContent = pad(t.minutes);
        secondsEl.textContent = pad(t.seconds);
        mainBig.textContent = `${t.hours+ t.days*24}:${pad(t.minutes)}:${pad(t.seconds)}`;
        statusLine.textContent = `Faltan ${t.days}d ${t.hours}h ${t.minutes}m ${t.seconds}s para las 11:00 (hora de España).`;
      } else {
        // already passed today 11:00 -> show elapsed since arrival and also next day's countdown in smaller way
        const elapsedMs = -diff;
        const e = msToParts(elapsedMs);
        daysEl.textContent = e.days;
        hoursEl.textContent = pad(e.hours);
        minutesEl.textContent = pad(e.minutes);
        secondsEl.textContent = pad(e.seconds);
        mainBig.textContent = `+${e.hours + e.days*24}:${pad(e.minutes)}:${pad(e.seconds)}`;
        // countdown to next day's 11:00
        const tomorrowTarget = madridTargetUtcMs(p.year, p.month, p.day+1, 11,0,0);
        const toTomorrow = Math.max(0, tomorrowTarget - nowMs);
        const t2 = msToParts(toTomorrow);
        statusLine.textContent = `Llegó hace ${e.days}d ${e.hours}h ${e.minutes}m ${e.seconds}s. Próxima 11:00 en ${t2.days}d ${t2.hours}h ${t2.minutes}m ${t2.seconds}s.`;
      }
    }

    function msToParts(ms){
      const totalSeconds = Math.floor(ms/1000);
      const seconds = totalSeconds % 60;
      const totalMinutes = Math.floor(totalSeconds/60);
      const minutes = totalMinutes % 60;
      const totalHours = Math.floor(totalMinutes/60);
      const hours = totalHours % 24;
      const days = Math.floor(totalHours/24);
      return {days, hours, minutes, seconds};
    }

    // Start updates
    update();
    setInterval(update, 200);

    // show current Madrid wall-time for clarity in console (optional)
    setInterval(()=>{
      const p = madridPartsFor(new Date());
      // e.g. 2025-11-18 11:00:00
      // no UI element needed, but could be enabled for debug
      // console.log('Madrid now', `${p.year}-${p.month}-${p.day} ${p.hour}:${p.minute}:${p.second}`);
    },10000);
  </script>
</body>
</html>
